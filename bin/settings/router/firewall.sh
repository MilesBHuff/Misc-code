#!/bin/bash
## Copyright Â© by Miles Bradley Huff from 2016 per the LGPL3 (the Third Lesser GNU Public License)
## Since there's already a stateful firewall set-up in the router, and since the
## port-forwarding/etc settings are probably just GUIs for iptables;  this
## "firewall" script is just going to be my own computer's sysctl tweaks, edited to
## work on my router.

#echo '0' > /proc/sys/net/ipv4/conf/all/arp_notify
#echo '1' > /proc/sys/net/ipv4/icmp_errors_use_inbound_ifaddr
echo '1' > /proc/sys/net/ipv4/icmp_ignore_bogus_error_responses
echo '1' > /proc/sys/net/ipv4/conf/all/log_martians
echo '0' > /proc/sys/vm/block_dump
#echo '0' > /proc/sys/vm/oom_dump_tasks
#echo '0' > /proc/sys/vm/panic_on_oom
#echo '2' > /proc/sys/kernel/io_delay_type
#echo '1' > /proc/sys/vm/compact_memory
#echo '0' > /proc/sys/vm/compact_unevictable_allowed
#echo '0' > /proc/sys/vm/memory_failure_early_kill
#echo '0' > /proc/sys/vm/oom_kill_allocating_task
#echo '8192' > /proc/sys/vm/admin_reserve_kbytes
#echo '8192' > /proc/sys/vm/user_reserve_kbytes
echo '0' > /proc/sys/vm/overcommit_memory
#echo '100' > /proc/sys/vm/overcommit_ratio
#echo '66' > /proc/sys/vm/swappiness
#echo '33' > /proc/sys/vm/vfs_cache_pressure
#echo '1' > /proc/sys/vm/zone_reclaim_mode
#echo '1' > /proc/sys/vm/memory_failure_recovery
#echo '0' > /proc/sys/vm/legacy_va_layout
#echo '0' > /proc/sys/vm/stat_interval
#echo 'fq_codel' > /proc/sys/net/core/default_qdisc
echo '1' > /proc/sys/net/ipv4/conf/all/forwarding
#echo '1' > /proc/sys/net/ipv4/cipso_cache_enable
#echo '1' > /proc/sys/net/ipv4/cipso_rbm_optfmt
#echo '0' > /proc/sys/net/ipv4/cipso_rbm_structvalid
#echo '2' > /proc/sys/net/ipv4/conf/all/app_solicit
#echo '1' > /proc/sys/net/ipv4/conf/all/arp_accept
echo '1' > /proc/sys/net/ipv4/conf/all/arp_announce
echo '0' > /proc/sys/net/ipv4/conf/all/arp_filter
echo '0' > /proc/sys/net/ipv4/conf/all/arp_ignore
#echo '2' > /proc/sys/net/ipv4/conf/all/mcast_resolicit
echo '1' > /proc/sys/net/ipv4/conf/all/proxy_arp
#echo '1' > /proc/sys/net/ipv4/conf/all/proxy_arp_pvlan
#echo '1' > /proc/sys/net/ipv4/fib_multipath_use_neigh
echo '1' > /proc/sys/net/ipv4/tcp_window_scaling
echo '1' > /proc/sys/net/ipv4/tcp_moderate_rcvbuf
echo '256960' > /proc/sys/net/core/rmem_default
echo '256960' > /proc/sys/net/core/wmem_default
echo '4096 256960 6291456' > /proc/sys/net/ipv4/tcp_rmem
echo '4096 256960 4194304' > /proc/sys/net/ipv4/tcp_wmem
echo '0' > /proc/sys/net/ipv4/tcp_abort_on_overflow
#echo '1' > /proc/sys/net/ipv4/tcp_autocorking
#echo '1' > /proc/sys/net/ipv4/ip_early_demux
#echo 'cubic' > /proc/sys/net/ipv4/tcp_congestion_control
echo '2' > /proc/sys/net/ipv4/tcp_ecn
#echo '1' > /proc/sys/net/ipv4/tcp_ecn_fallback
echo '0' > /proc/sys/net/ipv4/tcp_timestamps
echo '1' > /proc/sys/net/ipv4/tcp_no_metrics_save
#echo '0' > /proc/sys/net/ipv4/tcp_slow_start_after_idle
#echo '1539' > /proc/sys/net/ipv4/tcp_fastopen
echo '0' > /proc/sys/net/ipv4/tcp_low_latency
#echo '1' > /proc/sys/net/ipv4/tcp_thin_linear_timeouts
#echo '1' > /proc/sys/net/ipv4/tcp_thin_dupack
#echo '1' > /proc/sys/net/ipv4/conf/all/promote_secondaries
#echo '3' > /proc/sys/net/ipv4/tcp_early_retrans
echo '1' > /proc/sys/net/ipv4/tcp_frto
#echo '1' > /proc/sys/net/ipv4/tcp_recovery
echo '1' > /proc/sys/net/ipv4/ip_dynaddr
echo '1' > /proc/sys/net/ipv4/ip_nonlocal_bind
#echo '1' > /proc/sys/net/ipv4/tcp_l3mdev_accept
#echo '1' > /proc/sys/net/ipv4/tcp_mtu_probing
echo '1' > /proc/sys/net/ipv4/tcp_retrans_collapse
echo '0' > /proc/sys/net/ipv4/tcp_stdurg
#echo '1' > /proc/sys/net/ipv4/tcp_workaround_signed_windows
echo '1' > /proc/sys/net/ipv4/tcp_sack
echo '1' > /proc/sys/net/ipv4/tcp_dsack
echo '1' > /proc/sys/net/ipv4/tcp_fack
echo '1' > /proc/sys/net/ipv4/tcp_tw_reuse
echo '0' > /proc/sys/net/ipv4/tcp_tw_recycle
#echo '1' > /proc/sys/net/ipv6/conf/all/disable_ipv6
#echo '1' > /proc/sys/kernel/dmesg_restrict
#echo '1' > /proc/sys/kernel/kptr_restrict
#echo '0' > /proc/sys/kernel/yama/ptrace_scope
#echo '0' > /proc/sys/net/core/bpf_jit_enable
echo '1' > /proc/sys/net/ipv4/conf/all/accept_redirects
#echo '1' > /proc/sys/net/ipv6/conf/all/accept_redirects
echo '1' > /proc/sys/net/ipv4/conf/all/accept_source_route
#echo '1' > /proc/sys/net/ipv6/conf/all/accept_source_route
echo '1' > /proc/sys/net/ipv4/conf/all/send_redirects
echo '1' > /proc/sys/net/ipv4/conf/all/secure_redirects
echo '2' > /proc/sys/net/ipv4/conf/all/rp_filter
echo '1' > /proc/sys/net/ipv4/conf/all/shared_media
#echo '1' > /proc/sys/net/ipv4/conf/all/route_localnet
#echo '1' > /proc/sys/net/ipv4/conf/all/accept_local
echo '0' > /proc/sys/net/ipv4/conf/all/bootp_relay
#echo '1' > /proc/sys/net/ipv4/conf/all/drop_unicast_in_l2_multicast
echo '1' > /proc/sys/net/ipv4/conf/all/rp_filter
echo '1' > /proc/sys/net/ipv4/conf/all/secure_redirects
#echo '1' > /proc/sys/net/ipv4/fwmark_reflect
echo '0' > /proc/sys/net/ipv4/icmp_echo_ignore_all
echo '0' > /proc/sys/net/ipv4/icmp_echo_ignore_broadcasts
echo '250' > /proc/sys/net/ipv4/icmp_ratelimit
#echo '250' > /proc/sys/net/ipv4/tcp_challenge_ack_limit
echo '350233' > /proc/sys/net/ipv4/icmp_ratemask
echo '1200' > /proc/sys/net/ipv4/tcp_keepalive_time
echo '4' > /proc/sys/net/ipv4/tcp_keepalive_probes
echo '30' > /proc/sys/net/ipv4/tcp_keepalive_intvl
echo '180000' > /proc/sys/net/ipv4/tcp_max_tw_buckets
#echo '500' > /proc/sys/net/ipv4/tcp_invalid_ratelimit
echo '0' > /proc/sys/net/ipv4/ip_no_pmtu_disc
#echo '0' > /proc/sys/net/ipv4/ip_forward_use_pmtu
echo '4096' > /proc/sys/net/ipv4/tcp_max_orphans
echo '30' > /proc/sys/net/ipv4/tcp_fin_timeout
echo '1' > /proc/sys/net/ipv4/tcp_rfc1337
echo '1' > /proc/sys/net/ipv4/tcp_syncookies
echo '2' > /proc/sys/net/ipv4/tcp_syn_retries
echo '2' > /proc/sys/net/ipv4/tcp_synack_retries
echo '65536' > /proc/sys/vm/mmap_min_addr
